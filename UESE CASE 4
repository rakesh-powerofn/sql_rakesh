Q1)
SELECT D.ID AS ID,D.NAME AS DEPARTMENT,COUNT(E.DEPARTMENT) AS STRENGTH FROM DEPARTMENT D JOIN EMPLOYEE E ON E.DEPARTMENT = D.ID GROUP BY D.ID;
Q2)
SELECT E.ID AS ID,E.NAME AS EMPLOYEE,(CASE WHEN (SELECT L2 FROM REPORTING WHERE ID = E.ID) IS NULLTHEN '-'ELSE (SELECT NAME FROM EMPLOYEE WHERE ID =(SELECT L2 FROM REPORTING WHERE ID = E.ID))END) AS L2,(CASE WHEN (SELECT L1 FROM REPORTING WHERE ID = E.ID) IS NULLTHEN '-'ELSE (SELECT NAME FROM EMPLOYEE WHERE ID = (SELECT L1 FROM REPORTING WHERE ID = E.ID))END) AS L1 FROM EMPLOYEE E ;
q3)
SELECT E.ID AS ID,E.NAME AS EMPLOYEE,E.DEPARTMENT AS DEPARTMENT,(CASE WHEN(SELECT ACTIVE FROM EMPLOYEE WHERE ID = E.ID) = 1THEN 'ACTIVE'ELSE 'RESIGN'END )AS STATUS,(CASE WHEN(SELECT GENDER FROM EMPLOYEE WHERE ID = E.ID) = 'M'THEN 'MALE'ELSE 'FEMALE'END)AS GENDER,CONCAT(CONCAT(CONCAT(TIMESTAMPDIFF(YEAR,EM.ACTIVE_FROM,CURDATE()),' YEARS '),CONCAT(TIMESTAMPDIFF(MONTH,EM.ACTIVE_FROM,CURDATE()) DIV 12,' MONTHS ')),CONCAT(TIMESTAMPDIFF(DAY,EM.ACTIVE_FROM,CURDATE()) DIV (30*12),' DAYS '))AS TERMFROM EMPLOYEE E JOIN EMP_ACTIVE_DATE EM WHERE EM.ID=E.ID;;
q4)
select EMPLOYEE.ID,EMPLOYEE.NAME,EMPLOYEE.DEPARTMENT,DATEDIFF(curdate(),EMP_ACTIVE_DATE.ACTIVE_FROM) as DAYS from EMPLOYEE join EMP_ACTIVE_DATE on EMPLOYEE.iD=EMP_ACTIVE_DATE.ID where DATEDIFF(curdate(),EMP_ACTIVE_DATE.ACTIVE_FROM)>1500;
q5)
select DEPARTMENT.NAME as DEPARTMENT,(COUNT(if(GENDER='F',1,null))*100/count(if(GENDER='F',1,1))) as PERCENT from DEPARTMENT join EMPLOYEE on DEPARTMENT.ID=EMPLOYEE.DEPARTMENT group by DEPARTMENT.NAME;
